# __ISFB Analysis Tools__


## **gozi.bin**
ISFB aka Gozi is a banking trojan mawlare,that has come a long way from being just a basic info stealer to a fully fledged banking trojan malware that's looking to get access to your financial information,steals your bank account's credentials and much more.
Gozi.bin is an interesting 1st loader variant of ISFB,that unlike the other variants i looked at doesn't use a hardcoded string of the compilation date as the seed in the config decryption algorithm,instead the seed is dynamically generated at run-time making it harder to write a config extractor for it.However with the help of a fellow analyst **hexamine** which recognized that it uses a value between 1 and 19 for the algorithm to work ,i wrote that config extractor __isfb_2nd_variant.py__.                                                                                                                           

## __isfb_2nd_variant.py__

A little python3 script i wrore to replicate the decoding algorithm in __gozi.bin__ ,to automate the process of extracting and dumping the 1st loader config.Just run the script and provide the path to the ISFB file.

Tesed on the provied gozi.bin.



## __bytes__

A text file with the decoded config raw bytes to patch the sample with.



## __patch_isfb.py__

IDAPython script to patch the encoded 1st stage config at bss with the decoded bytes.


## __note__:
Almost for all ISFB variants the encrypted config is stored in bss,so you'll see reference to that.
