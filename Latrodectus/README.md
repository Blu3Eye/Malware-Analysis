# Latrodecuts new version string decryption

This script was specifically written to extract and decrypt strings in the new version of the **Latrodectus** loader.
It was noticed that in the new version, the authors implemented AES-256 string encryption and decryption. It was noticed as well that they didn't use Microsoft crypto APIs but rather hardcoded the algorithm.

## Prerequisites
* python 3.x


## Usage
The script will find the string decryption function by name, so you need to find and rename the function first as you wish but make sure you do so as well in the script. In my case, I renamed the string decryption routine __"aes_ctr_mode_str_decrypt"__. 
Next thing you need to import the script into IDA the same way you import any IDAPython script.

## Output 
Upon successful string decryption, you should get the "Latrodectus_strings.txt" file where you can examine the decrypted strings, also you should see the decrypted strings added as comments next to the decryption routine call.

<p align="center">
  <img src="strings.png" alt="" />
  <br>
  <span style="display: block; text-align: center;">Latrodectus decrypted strings</span>
</p>


<p align="center">
  <img src="func_xrefs.png" alt="" />
  <br>
  <span style="display: block; text-align: center;">comments added next to function calls</span>
</p>



