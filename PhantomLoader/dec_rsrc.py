import sys 

def decrypt_rsrc_file(data,key):
    data_bytes = bytearray(data)
    count = 0x3D0914
    while count != 0:
        buffer =[i for i in range(0x6B)]
        count-=1
    for i in range(len(data)):
        val = 0x19C * buffer[0] // 0x29D - 0x46D0 * buffer[0] * buffer[66]
        key_index = i + val - 26 * (i // len(key))
        key_index %= len(key)
        data_bytes[i] ^= key[key_index]
    return bytes(data_bytes)       

if __name__ == '__main__':
    filepath = sys.argv[1]
    key = [0x59,0x4b,0x66,0x50,0x6c,0x72,0x76,0x4c,0x70,0x30,0x3c,0x42,0x61,0x73,0x26,0x4A,0x3E,0x25,0x64,0x75,0x5a,0x4e,0x74,0x40,0x6c,0x0]
    decrypted_data = bytes()
    if filepath:
        with open(filepath,"rb") as f:
            data = f.read()
            decrypted_data = decrypt_rsrc_file(data,key)
            f.close()
        with open("dec_rsrc.bin","wb") as f:
            f.write(decrypted_data)
        
            